name: Install Thapi master and develop every week
on:
  schedule:
    # At 00:00 on Sunday.‚Äù
    - cron: "0 0 * * 0"
  workflow_dispatch:
jobs:
  install_thapi_dependencies:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - uses: ./.github/actions/cache-spack
      with:
        mode: 'upload'
  install_thapi:
    strategy:
      matrix:
        version: ['thapi', 'thapi@develop']
    needs: install_thapi_dependencies
    runs-on: ubuntu-latest
    name: Install ${{ matrix.version }}
    steps:
    - name: Download Spack Cache
      uses: ./.github/actions/cache-spack
      with:
        mode: 'download'
    - run: |
        . external/spack/share/spack/setup-env.sh
        spack install ${{ matrix.version }}
